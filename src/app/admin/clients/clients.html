<div class="clients-container">
  <header class="page-header">
    <button class="btn-back" (click)="backToDashboard()">â† Volver al Dashboard</button>
    <h1 class="page-title">Historial de <span class="highlight">Clientes</span></h1>
  </header>

  <div class="clients-content">
    <section class="toolbar">
      <div class="search-box">
        <input 
          type="text" 
          class="search-input" 
          placeholder="Buscar por nombre, email o telÃ©fono..."
          (input)="onSearch($event)">
      </div>

      <div class="toolbar-actions">
        <button class="btn-export" (click)="exportToExcel()">
          ğŸ“Š Exportar a Excel
        </button>
      </div>
    </section>

    <section class="clients-section">
      <div class="section-header">
        <h2 class="section-title">
          {{ filteredClients.length }} 
          {{ filteredClients.length === 1 ? 'cliente encontrado' : 'clientes encontrados' }}
        </h2>
      </div>

      <app-client-list
        [clients]="filteredClients"
        [loading]="loading"
        (clientSelected)="onClientSelected($event)"
        (viewHistory)="onViewHistory($event)">
      </app-client-list>
    </section>
  </div>

  <div class="modal-overlay" *ngIf="showHistory" (click)="closeHistory()">
    <div class="history-modal" (click)="$event.stopPropagation()">
      <button class="close-button" (click)="closeHistory()">âœ•</button>

      <div class="modal-header">
        <div class="client-avatar-large">
          {{ selectedClient?.name?.charAt(0)?.toUpperCase() }}
        </div>
        <div class="client-details">
          <h2 class="client-name">{{ selectedClient?.name }}</h2>
          <p class="client-email">{{ selectedClient?.email }}</p>
          <p class="client-phone">{{ selectedClient?.phone }}</p>
        </div>
      </div>

      <div class="modal-body">
        <h3 class="history-title">Historial de Citas</h3>
        
        <div class="history-list" *ngIf="clientHistory.length > 0">
          <div class="history-item" *ngFor="let appointment of clientHistory">
            <div class="history-date">
              <span class="date-icon">ğŸ“…</span>
              <span class="date-text">{{ appointment.date | date:'d MMM yyyy':'':'es' }}</span>
            </div>
            <div class="history-details">
              <h4 class="history-service">{{ appointment.service }}</h4>
              <p class="history-time">{{ appointment.time }}</p>
            </div>
            <div class="history-status completed">
              <span class="status-badge">Completada</span>
            </div>
          </div>
        </div>

        <div class="empty-history" *ngIf="clientHistory.length === 0">
          <p>No hay historial de citas para este cliente</p>
        </div>
      </div>
    </div>
  </div>
</div>